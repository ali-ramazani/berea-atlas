{% extends "base.html" %}
{% block content %}
<section class="bg-white border rounded-xl p-6 shadow-sm">
  <h1 class="text-xl font-semibold mb-4">Admin Login</h1>
  <form id="loginForm" class="space-y-4">
    <div>
      <label class="block text-sm mb-1">Email</label>
      <input type="email" name="email" required
             class="w-full border rounded-lg px-3 py-2" placeholder="admin@berea.edu">
    </div>
    <div>
      <label class="block text-sm mb-1">Password</label>
      <input type="password" name="password" required
             class="w-full border rounded-lg px-3 py-2" placeholder="admin">
    </div>
    <div id="err" class="text-sm text-red-600 hidden"></div>
    <button class="bg-slate-900 text-white px-4 py-2 rounded-lg">Sign in</button>
  </form>
</section>

<script>
  const form = document.getElementById('loginForm');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const err = document.getElementById('err');
    err.classList.add('hidden');
    const email = form.email.value.trim().toLowerCase();
    const password = form.password.value;
    const res = await fetch('/auth/login', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ email, password })
    });
    if (res.ok) {
      location.href = '/admin/home';
    } else {
      const data = await res.json().catch(()=>({error:'Login failed'}));
      err.textContent = data.error || 'Invalid credentials';
      err.classList.remove('hidden');
    }
  });
</script>
{% endblock %}
